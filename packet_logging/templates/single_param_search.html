{% extends 'layout.html' %}
{% load staticfiles %}
{% block content %}

<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    single param search
    <small>search in elasticsearch packet documents with single param</small>
  </h1>
  <ol class="breadcrumb">
    <li><a href="/"><i class="fa fa-dashboard"></i> Home</a></li>
    <li class="active">single param search</li>
  </ol>
</section>
<!-- Main content -->
<section class="content">

  <div class="box box-default">
    <div class="box-body">
      <form class="form-inline" role="form" method="post">
        {% csrf_token %}
        <div class="form-group">
          <label for="searchterm">Search :</label>
          <input type="text" class="form-control" id="searchterm" name="searchterm">
        </div>
        <div class="form-group">
          <label for="searchterm">Search by :</label>
          <select name="searchby" class="form-control select2 select2-hidden-accessible">
            <option value="version">version</option>
            <option value="ip_header_length">ip header length</option>
            <option value="ttl">ttl</option>
            <option value="protocol">protocol</option>
            <option value="source_address">source address</option>
            <option value="destination_address">destination address</option>
            <option value="source_port">source port</option>
            <option value="dest_port">dest port</option>
            <option value="sequence_number">sequence number</option>
            <option value="acknowledgement">acknowledgement</option>
            <option value="tcp_header_length">tcp header length</option>
            <option value="data">data</option>
            <option value="datetime">datetime</option>
          </select>
        </div>
        <button type="submit" class="btn btn-default">Search</button>
      </form>
    </div><!-- /.box-body -->
  </div><!-- /.box -->
  <!-- show the results -->
  {% if log_results != None %}
  <table class="table table-striped">
    <thead>
      <tr>
        <th>version</th>
        <th>ip header length</th>
        <th>ttl</th>
        <th>protocol</th>
        <th>source address</th>
        <th>destination address</th>
        <th>source port</th>
        <th>dest port</th>
        <th>sequence number</th>
        <th>acknowledgement</th>
        <th>tcp header length</th>
        <th>data</th>
        <th>datetime</th>
      </tr>
    </thead>
    <tbody>
      {% for doc in log_results %}
      <tr>
        <td>{{doc.version}}</td>
        <td>{{doc.ip_header_length}}</td>
        <td>{{doc.ttl}}</td>
        <td>{{doc.protocol}}</td>
        <td>{{doc.source_address}}</td>
        <td>{{doc.destination_address}}</td>
        <td>{{doc.source_port}}</td>
        <td>{{doc.dest_port}}</td>
        <td>{{doc.sequence_number}}</td>
        <td>{{doc.acknowledgement}}</td>
        <td>{{doc.tcp_header_length}}</td>
        <td>{{doc.data}}</td>
        <td>{{doc.datetime}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% endif %}
  <!-- end of showing the results -->
</section>
{% endblock %}
